import{a as G,b,c as N,d as V,h as H,i as O,j as q,k as D,m as B}from"./chunk-Q3WU5MBH.js";import{p as M,y as P}from"./chunk-NV6MERPE.js";import{$a as A,Cb as T,Db as g,Kb as a,Lb as L,Mb as R,Qb as x,R as S,Ra as r,Rb as k,Sb as y,W as E,X as v,ca as w,da as I,ea as p,eb as m,fa as u,kb as f,ob as s,sb as e,tb as i,ub as d,xb as F}from"./chunk-PF3VOX7V.js";import"./chunk-EQDQRRRY.js";var _=class t{constructor(o){this.httpClient=o;console.log(this.myToken)}myToken=localStorage.getItem("token");getAllOrders(){return this.httpClient.get("https://ecommerce.routemisr.com/api/v1/orders/")}checkoutSession(o,n){return this.httpClient.post(`https://ecommerce.routemisr.com/api/v1/orders/checkout-session/${o}?url=http://localhost:4200`,{shippingAddress:n})}static \u0275fac=function(n){return new(n||t)(E(M))};static \u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"})};function Z(t,o){t&1&&(e(0,"span",19),a(1,"Address Details is Required!"),i())}function U(t,o){if(t&1&&(e(0,"div",5),p(),e(1,"svg",16),d(2,"path",17),i(),u(),e(3,"span",18),a(4,"Info"),i(),e(5,"div"),m(6,Z,2,0,"span",19),i()()),t&2){g();let n=y(7);r(6),s(n!=null&&n.getError("required")?6:-1)}}function z(t,o){t&1&&(e(0,"span",19),a(1,"phone is Required!"),i())}function J(t,o){t&1&&(e(0,"span",19),a(1,"should to be egyption valid Number!"),i())}function K(t,o){if(t&1&&(e(0,"div",5),p(),e(1,"svg",16),d(2,"path",17),i(),u(),e(3,"span",18),a(4,"Info"),i(),e(5,"div"),m(6,z,2,0,"span",19)(7,J,2,0,"span",19),i()()),t&2){g();let n=y(13);r(6),s(n!=null&&n.getError("required")?6:n!=null&&n.getError("pattern")?7:-1)}}function Q(t,o){t&1&&(e(0,"span",19),a(1,"City is Required!"),i())}function W(t,o){if(t&1&&(e(0,"div",5),p(),e(1,"svg",16),d(2,"path",17),i(),u(),e(3,"span",18),a(4,"Info"),i(),e(5,"div"),m(6,Q,2,0,"span",19),i()()),t&2){g();let n=y(19);r(6),s(n!=null&&n.getError("required")?6:-1)}}function X(t,o){if(t&1&&(e(0,"div",12),p(),e(1,"svg",16),d(2,"path",17),i(),u(),e(3,"span",18),a(4,"Info"),i(),e(5,"div")(6,"span",19),a(7),i()()()),t&2){let n=g();r(7),R("",n.msgError,"!")}}function Y(t,o){if(t&1&&(e(0,"div",13),p(),e(1,"svg",16),d(2,"path",17),i(),u(),d(3,"span",18),e(4,"div")(5,"span",19),a(6),i()()()),t&2){let n=g();r(6),L(n.msgSuccess)}}function ee(t,o){t&1&&(e(0,"span"),d(1,"i",20),i())}function te(t,o){t&1&&(e(0,"span"),d(1,"i",20),i())}var j=class t{isLoading=!1;msgSuccess="";msgError="";formBuilder=v(D);ordersService=v(_);activatedRoute=v(P);paramCartId="";checkoutRes={};shippingAddressForm;ngOnInit(){this.paramCartId=this.getParamCartId(),this.initShippingForm()}initShippingForm(){this.shippingAddressForm=this.formBuilder.group({details:[null,b.required],phone:[null,[b.required,b.pattern(/^01[0125][0-9]{8}$/)]],city:[null,b.required]})}getParamCartId(){return this.activatedRoute.snapshot.paramMap.get("cartId")||""}submitForm(){this.shippingAddressForm.valid&&(console.log(this.shippingAddressForm.value),this.ordersService.checkoutSession(this.paramCartId,this.shippingAddressForm.value).subscribe({next:o=>{this.checkoutRes=o,console.log(this.checkoutRes),this.checkoutRes.status==="success"&&open(this.checkoutRes.session.url,"_self")},error:o=>{console.log(o)}}))}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=A({type:t,selectors:[["app-checkout"]],decls:31,vars:14,consts:[[1,"w-9/12","mx-auto","border","rounded-lg","p-5","shadow","shadow-main-color/75",3,"ngSubmit","formGroup"],[1,"text-3xl","mb-5","font-medium","w-fit","mx-auto","border-b-main-color/80","border-b","text-main-color","capitalize"],[1,"mb-4"],["for","details","ariaPlaceholder","Details Address",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white",3,"autofocus"],["formControlName","details","type","text","placeholder","Details Address","id","details",1,"bg-gray-50","border","border-gray-300","text-gray-900","drop-shadow-md","text-sm","rounded-lg","focus:ring-main-color","focus:border-main-color","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-main-color","dark:focus:border-main-color"],["role","alert",1,"flex","items-center","p-4","my-3","text-sm","text-red-800","border","border-red-300","rounded-lg","bg-red-50","dark:bg-gray-800","dark:text-red-400","dark:border-red-800"],["for","phone","ariaPlaceholder","Egyption Phone",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["placeholder","01200523080","formControlName","phone","type","tel","id","phone",1,"bg-gray-50","border","border-gray-300","text-gray-900","drop-shadow-md","text-sm","rounded-lg","focus:ring-main-color","focus:border-main-color","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-main-color","dark:focus:border-main-color"],[1,"mb-2"],["for","city","ariaPlaceholder","city Address",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","city","type","text","placeholder","City / Area","id","city",1,"bg-gray-50","border","border-gray-300","text-gray-900","drop-shadow-md","text-sm","rounded-lg","focus:ring-main-color","focus:border-main-color","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-main-color","dark:focus:border-main-color"],[1,"flex","justify-between","items-center","content-center"],["role","alert",1,"flex","items-center","p-2","text-sm","text-red-800","border","border-red-300","rounded-lg","bg-red-50","dark:bg-gray-800","dark:text-red-400","dark:border-red-800"],["role","alert",1,"flex","items-center","p-2","text-sm","text-green-800","border","border-green-300","rounded-lg","bg-green-50","dark:bg-gray-800","dark:text-green-400","dark:border-green-800"],["type","button",1,"btn-main-outline","hover:text-green-800","!disabled:hover:text-green-800","!bg-transparent","ms-auto","me-2","mt-6","!px-2","block","focus:ring-main-color","focus:outline-main-color",3,"disabled"],["type","submit",1,"btn-main","mt-6","block","!px-2","focus:ring-main-color","focus:outline-main-color",3,"disabled"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 20 20",1,"shrink-0","inline","w-4","h-4","me-3"],["d","M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"],[1,"sr-only"],[1,"font-medium","block"],[1,"fas","fa-spin","fa-spinner"]],template:function(n,l){if(n&1){let c=F();e(0,"section")(1,"form",0),T("ngSubmit",function(){return w(c),I(l.submitForm())}),e(2,"h4",1),a(3," checkout payment "),i(),e(4,"div",2)(5,"label",3),a(6,"Details Address:"),i(),x(7),d(8,"input",4),m(9,U,7,1,"div",5),i(),e(10,"div",2)(11,"label",6),a(12,"Phone:"),i(),x(13),d(14,"input",7),m(15,K,8,1,"div",5),i(),e(16,"div",8)(17,"label",9),a(18,"City / Area:"),i(),x(19),d(20,"input",10),m(21,W,7,1,"div",5),i(),e(22,"div",11),m(23,X,8,1,"div",12)(24,Y,7,1,"div",13),e(25,"button",14),a(26," Cash Credit Payment "),m(27,ee,2,0,"span"),i(),e(28,"button",15),a(29," Online Credit Payment "),m(30,te,2,0,"span"),i()()()()}if(n&2){r(),f("formGroup",l.shippingAddressForm),r(4),f("autofocus",!0),r(2);let c=k(l.shippingAddressForm.get("details"));r(2),s(c!=null&&c.errors&&(c!=null&&c.touched)?9:-1),r(4);let h=k(l.shippingAddressForm.get("phone"));r(2),s(h!=null&&h.errors&&(h!=null&&h.touched)?15:-1),r(4);let C=k(l.shippingAddressForm.get("city"));r(2),s(C!=null&&C.errors&&(C!=null&&C.touched)?21:-1),r(2),s(l.msgError?23:-1),r(),s(l.msgSuccess?24:-1),r(),f("disabled",l.shippingAddressForm.invalid||l.isLoading),r(2),s(l.isLoading?27:-1),r(),f("disabled",l.shippingAddressForm.invalid||l.isLoading),r(2),s(l.isLoading?30:-1)}},dependencies:[B,H,G,N,V,O,q],styles:[".hover[_ngcontent-%COMP%]:text-green-800:hover{color:green!important}"]})};export{j as CheckoutComponent};
