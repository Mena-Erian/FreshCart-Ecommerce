import './polyfills.server.mjs';
import{a as G}from"./chunk-37TAVD7X.mjs";import{a as M,b as x,c as N,d as H,e as I,f as _,h as R,i as q,j as A,m as P}from"./chunk-ZKBHIU2R.mjs";import{M as V,N as D}from"./chunk-MREIMAJP.mjs";import{Cb as E,Hb as y,Ib as f,Pb as r,Qb as v,Ua as a,Vb as L,Wb as F,X as b,Xb as T,a as h,cb as w,da as S,ea as C,fa as g,ga as u,hb as d,pb as k,tb as s,xb as e,yb as n,zb as m}from"./chunk-CQFKIR7E.mjs";import"./chunk-S6KH3LOX.mjs";function Z(t,i){t&1&&(e(0,"span",16),r(1,"Email is Required!"),n())}function j(t,i){t&1&&(e(0,"span",16),r(1,"Email not Valid!"),n())}function $(t,i){if(t&1&&(e(0,"div",5),g(),e(1,"svg",13),m(2,"path",14),n(),u(),e(3,"span",15),r(4,"Info"),n(),e(5,"div"),d(6,Z,2,0,"span",16)(7,j,2,0,"span",16),n()()),t&2){f();let o=T(5);a(6),s(o!=null&&o.getError("required")?6:o!=null&&o.getError("email")?7:-1)}}function B(t,i){t&1&&(e(0,"span",16),r(1,"password is Required!"),n())}function U(t,i){t&1&&(e(0,"span",16),r(1,"password should to be more than 7 characters!"),n())}function W(t,i){if(t&1&&(e(0,"div",5),g(),e(1,"svg",13),m(2,"path",14),n(),u(),e(3,"span",15),r(4,"Info"),n(),e(5,"div"),d(6,B,2,0,"span",16)(7,U,2,0,"span",16),n()()),t&2){let o,l=f();a(6),s((o=l.loginForm.get("password"))!=null&&o.getError("required")?6:(o=l.loginForm.get("password"))!=null&&o.getError("pattern")?7:-1)}}function z(t,i){if(t&1&&(e(0,"div",10),g(),e(1,"svg",13),m(2,"path",14),n(),u(),m(3,"span",15),e(4,"div")(5,"span",16),r(6),n()()()),t&2){let o=f();a(6),v(o.msgError)}}function J(t,i){if(t&1&&(e(0,"div",11),g(),e(1,"svg",13),m(2,"path",14),n(),u(),m(3,"span",15),e(4,"div")(5,"span",16),r(6),n()()()),t&2){let o=f();a(6),v(o.msgSuccess)}}function K(t,i){t&1&&(e(0,"span"),m(1,"i",17),n())}var O=class t{authService=b(G);router=b(V);msgError="";msgSuccess="";isLoading=!1;loginForm=new I({email:new _(null,[x.required,x.email]),password:new _(null,[x.required,x.pattern(/^[\w\.\*\+\?\^\$\(\)\[\]\{\}\|\!\@\#\%\&\~\W*]{6,}$/)])});cancelSubscription=new h;submitLogin(){this.authService.setDefaultEmail(this.loginForm.controls.email.value),this.loginForm.valid?(this.isLoading=!0,console.log(this.loginForm.value),this.cancelSubscription=this.authService.logIn(this.loginForm.value).subscribe({next:i=>{this.isLoading=!1,this.msgError="",this.msgSuccess=i.message,console.log(i),i.message==="success"&&(localStorage.setItem("token",i?.token),this.authService.saveUserData(),setTimeout(()=>{this.router.navigate(["/home"])},1e3))},error:i=>{this.isLoading=!1,console.log(i),this.msgError=i.error.message}})):this.loginForm.markAllAsTouched()}ngOnDestroy(){this.cancelSubscription.unsubscribe()}static \u0275fac=function(o){return new(o||t)};static \u0275cmp=w({type:t,selectors:[["app-login"]],decls:21,vars:7,consts:[[1,"w-11/12","mx-auto","sm:w-full","sm:mx-0"],[3,"ngSubmit","formGroup"],[1,"mb-4"],["for","mail",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","email","type","email","id","mail",1,"bg-gray-50","border","border-gray-300","text-gray-900","drop-shadow-md","text-sm","rounded-lg","focus:ring-main-color","focus:border-main-color","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-main-color","dark:focus:border-main-color"],["role","alert",1,"flex","items-center","p-4","my-3","text-sm","text-red-800","border","border-red-300","rounded-lg","bg-red-50","dark:bg-gray-800","dark:text-red-400","dark:border-red-800"],["for","pass",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","password","type","password","id","pass",1,"bg-gray-50","border","border-gray-300","text-gray-900","drop-shadow-md","text-sm","rounded-lg","focus:ring-main-color","focus:border-main-color","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-main-color","dark:focus:border-main-color"],[1,"flex","justify-between","align-middle","content-center","items-center"],["routerLink","/forgetPassword",1,"text-sm","text-sky-600","cursor-pointer"],["role","alert",1,"flex","items-center","p-2","mx-auto","text-sm","text-center","text-red-800","border","border-red-300","rounded-lg","bg-red-50","dark:bg-gray-800","dark:text-red-400","dark:border-red-800"],["role","alert",1,"flex","items-center","p-2","text-sm","text-green-800","border","border-green-300","rounded-lg","bg-green-50","dark:bg-gray-800","dark:text-green-400","dark:border-green-800"],["type","submit",1,"btn-main","block","ms-auto"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 20 20",1,"shrink-0","inline","w-4","h-4","me-3"],["d","M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"],[1,"sr-only"],[1,"font-medium","block"],[1,"fas","fa-spin","fa-spinner"]],template:function(o,l){if(o&1){let c=E();e(0,"section",0)(1,"form",1),y("ngSubmit",function(){return S(c),C(l.submitLogin())}),e(2,"div",2)(3,"label",3),r(4,"Email:"),n(),L(5),m(6,"input",4),d(7,$,8,1,"div",5),n(),e(8,"div",2)(9,"label",6),r(10,"Password:"),n(),m(11,"input",7),d(12,W,8,1,"div",5),n(),e(13,"div",8)(14,"span",9),r(15,"Forget Password?"),n(),d(16,z,7,1,"div",10)(17,J,7,1,"div",11),e(18,"button",12),r(19," login "),d(20,K,2,0,"span"),n()()()()}if(o&2){let c;a(),k("formGroup",l.loginForm),a(4);let p=F(l.loginForm.get("email"));a(2),s(p!=null&&p.touched&&(p!=null&&p.errors)?7:-1),a(5),s((c=l.loginForm.get("password"))!=null&&c.errors&&((c=l.loginForm.get("password"))!=null&&c.touched)?12:-1),a(4),s(l.msgError?16:-1),a(),s(l.msgSuccess?17:-1),a(3),s(l.isLoading?20:-1)}},dependencies:[P,R,M,N,H,q,A,D],encapsulation:2})};export{O as LoginComponent};
